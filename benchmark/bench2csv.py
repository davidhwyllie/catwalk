"""CLI for converting data generated by bench.py into a csv format."""

import json

import argh


def go(json_in_fn):
    """Main function."""
    with open(json_in_fn) as f:
        data = json.loads(f.read())

    with open(f"{json_in_fn}-times.csv", "w") as out:
        out.write("sample_name,comparison_distance,comparisons_time\n")
        for distance, times_dict in data["distance_times"].items():
            for sample_name, comparisons_time in times_dict.items():
                out.write(
                    ",".join([sample_name, str(distance), str(comparisons_time)]) + "\n"
                )

    with open(f"{json_in_fn}-stats.csv", "w") as out:
        out.write("sample_name,A,C,G,T,N\n")
        for sample_name, count_dict in data["sample_counts"].items():
            out.write(
                ",".join(
                    [
                        sample_name,
                        str(count_dict["A"]),
                        str(count_dict["C"]),
                        str(count_dict["G"]),
                        str(count_dict["T"]),
                        str(count_dict["N"]),
                    ]
                )
                + "\n"
            )


if __name__ == "__main__":
    argh.dispatch_command(go)
